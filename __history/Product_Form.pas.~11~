unit Product_Form;

interface

uses
  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,
  Dialogs, StdCtrls, Buttons, Grids, DBGrids, ExtCtrls;

type
  TPRODUCT = class(TForm)
    DBGrid1: TDBGrid;
    EditButton: TBitBtn;
    ADDButton: TBitBtn;
    DelButton: TBitBtn;
    CloseButton: TBitBtn;
    Panel1: TPanel;
    MonEdit: TEdit;
    procedure FormShow(Sender: TObject);
    procedure CloseButtonClick(Sender: TObject);
    procedure DelButtonClick(Sender: TObject);
    procedure EditButtonClick(Sender: TObject);
    procedure ADDButtonClick(Sender: TObject);
  private
    { Private declarations }
  public
    { Public declarations }
  end;

var
  PRODUCT: TPRODUCT;

implementation

uses DataModuleForm, Edit_Product_Form, Add_Product_Form;

{$R *.dfm}

procedure TPRODUCT.ADDButtonClick(Sender: TObject);
begin
Application.CreateForm(TAdd_product, Add_product);
Add_product.ShowModal;
end;

procedure TPRODUCT.CloseButtonClick(Sender: TObject);
begin
 DataModule.ds_ProdGroup.ReopenLocate('PG_ID');
 Close;
end;

procedure TPRODUCT.DelButtonClick(Sender: TObject);
begin
  DataModule.ds_product.Delete;
end;

procedure TPRODUCT.EditButtonClick(Sender: TObject);
begin
 Application.CreateForm(TEdit_Product, Edit_Product);
 Edit_Product.ShowModal;
end;

procedure TPRODUCT.FormShow(Sender: TObject);
Var f,SQLTEXT:string;
begin
  DataModule.ds_ProdGroup.ParamByName('X').AsInteger:=DataModule.ds_ProdGroup.FieldByName('PG_ID').AsInteger;
  DataModule.ds_ProdGroup.Open;
  Panel1.Caption :=DataModule.ds_ProdGroup.FieldByName('PG_NAME').AsString;
  MonEdit.Text :=DataModule.ds_ProdGroup.FieldByName('PG_ID').AsString;

  begin
  f:= Trim(MonEdit.Text);

  SQLTEXT:='SELECT TP_ID, TP_PGID, TP_NAME, TP_VOLUME, TP_UNITM, TP_GOST FROM T_PRODUCT';
  //ShowMessage('Вы действительно хотите отсортировать? '+f+'          Нажмите Ок');
  with DataModule.ds_product do
  begin
    DisableControls;
    Close;
    SelectSQL.Text:= SQLTEXT;
    if (Pos(' WHERE TP_PGID =: ', SelectSQL.Text) = 0) then
      SelectSQL.Add(' WHERE TP_PGID =' + f )
       else
        SelectSQL.Text:= SQLTEXT;

        Open;
        EnableControls;

  end;
end;

  //DataModule.ds_product.Close;
  //DataModule.ds_product.ParamByName('Perem').Value:=Trim(MOnEdit.Text);
  //DataModule.ds_product.Open;
  //cxButtonEdit2.Text:=DataModule.DS_T_USERS.FieldByName('Clients').AsString;
  //Edit1.Text:=DataModule.DS_T_USERS.FieldByName('U_NAME').AsString;
end;

end.
